var models = Array.new;
<% @models.each do |model| %>
  models.push(Array.new(<%= model.brand_id %>, '<%=h model.name %>', <%= model.id %>));
<% end %>

function brandSelected() {
  brand_id = $('new_brand_id').getValue();
  options = $('new_model_id').options;
  options.length = 1;
  models.each(function(model) {
    if (model[0] == brand_id) {
      options[options.length] = new Option(model[1], model[2]);
    }
  });
  if (options.length == 1) {
    $('model_field').hide();
  } else {
    $('model_field').show();
  }
}

document.observe('dom:loaded', function() {
  brandSelected();
  $('person_brand_id').observe('change', brandSelected);
});